
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Laser Labyrinth - Debug</title>
  <style>
    body { background: #111; color: white; font-family: sans-serif; margin: 0; }
    header { background: #222; padding: 10px; text-align: center; }
    #status { text-align: center; color: lime; margin: 10px; font-weight: bold; }
    canvas { display: block; margin: 20px auto; background: #000; border: 2px solid white; }
    #controls { text-align: center; margin-bottom: 20px; }
    #controls button {
      margin: 5px; padding: 10px 20px;
      font-size: 16px; background: #00ccff;
      border: none; border-radius: 5px; color: black;
    }
  </style>
</head>
<body>
  <header>Laser Labyrinth - Debug Version</header>
  <div id="status">Loading...</div>
  <canvas id="game" width="400" height="400"></canvas>
  <div id="controls">
    <button onclick="move(0, -1)">Up</button>
    <button onclick="move(-1, 0)">Left</button>
    <button onclick="move(1, 0)">Right</button>
    <button onclick="move(0, 1)">Down</button>
    <button onclick="fire()">Fire</button>
  </div>

  <script>
    window.onload = function() {
      const status = document.getElementById("status");
      status.innerText = "Game Loaded";

      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");

      if (!ctx) {
        status.innerText = "Canvas context failed to initialize.";
        return;
      }

      const gridSize = 8, cellSize = 50;
      let direction = { x: 1, y: 0 };
      let player = { x: 1, y: 1 };
      let target = { x: 6, y: 1 };
      const walls = [{ x: 4, y: 1 }];
      const mirrors = [
        { x: 2, y: 1, type: "/" },
        { x: 5, y: 2, type: "\" }
      ];

      function drawGrid(path = []) {
        status.innerText = "Drawing grid...";
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let y = 0; y < gridSize; y++) {
          for (let x = 0; x < gridSize; x++) {
            ctx.strokeStyle = "#333";
            ctx.strokeRect(x * cellSize, y * cellSize, cellSize, cellSize);
          }
        }

        ctx.fillStyle = "cyan";
        ctx.fillRect(player.x * cellSize + 10, player.y * cellSize + 10, 30, 30);

        ctx.fillStyle = "yellow";
        ctx.beginPath();
        ctx.arc(target.x * cellSize + 25, target.y * cellSize + 25, 10, 0, Math.PI * 2);
        ctx.fill();
      }

      window.move = function(dx, dy) {
        direction = { x: dx, y: dy };
        let nx = player.x;
        let ny = player.y;
        while (true) {
          const tx = nx + dx;
          const ty = ny + dy;
          if (tx < 0 || tx >= gridSize || ty < 0 || ty >= gridSize || walls.some(w => w.x === tx && w.y === ty)) break;
          nx = tx;
          ny = ty;
        }
        player.x = nx;
        player.y = ny;
        drawGrid();
      }

      window.fire = function() {
        drawGrid(); // trigger draw to test button
        status.innerText = "Fire button pressed!";
      }

      drawGrid();
    };
  </script>
</body>
</html>
